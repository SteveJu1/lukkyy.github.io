---
layout:     post
title:      "计算机网络体系结构 "
date:       2017-05-04 
categories: Web
tags: 网络五层协议
---





概念

ISP ：互联网服务提供商。为用户提供接入网络的服务，向用户收费，比如中国电信，移动等。ISP之间的传输速度较慢，有些网站下载的时候提供不同ISP的下载服务（电信下载，移动下载）

电路交换：两个用户之间会建立专用的网络通道，在通讯结束之前会一直占用线路。线路利用率往往不到 10%，比如电话通讯

分组交换：是将传输的内容分成一个个包裹，每个分组都有头部尾部记录着原地址、目标地址等信息。在一条线路上可以传输多个分组，分组之间不会相互影响，线路利用率要高很多。

时延：**总时延= 传输时延 + 传播时延+处理时延+排队时延**
传输时延：是主机或路由器把数据发送出去的时间， ( 数据帧的长度bit/传输速率)
传输时延：电磁波在信道中跑的时间，（信道的长度/传播速度）note:电磁波在同轴电缆中的速度比在光纤要快
处理时延：主机或路由器收到分组数据包后还要处理嘛，例如分析首部、从分组中提取数据、差错检验或查找路由表等
排队时延：分组在路由器的输入、输出队列中排队等待的时间，取决于网络当前的通信量（负载量）

​           

### 计算机网络的体系结构

![](https://lukkyy.github.io/assets/IT/Web/webProc.png)

#### 五层协议

五层协议是实际在使用的网络协议

**应用层** ：为特定应用程序传输数据服务，比如HTTP、POP、DNS，可以自己定义协议
**传输层：**为主机之间的进程通讯提供服务，包括两种协议：**传输控制协议TCP**，面向连接，可靠的数据传输；**用户数据包协议UDP**，无连接，尽最大努力传输数据，数据单位是用户数据包；TCP数据传输可靠，由于要验证传输的数据是否完整，实时性差。UDP提供及时性的服务，但数据可能会丢失；这层负责流量控制，可靠传输
​    note：微信发消息用TCP协议，保证消息能收到，视频聊天用的UDP，实时性好，但是数据丢失后视频会卡帧。
**网络层：**为主机之间数据传输提供服务，将传输层的数据分装成**分组**，规划**IP地址**在这一层加上

**数据链路层：**把网络层的数据装成**帧**，在帧加上**Mac地址**，透明传输、差错校验
**物理层：**负责将数据转成比特流，规定传输媒体的标准，网线、电压标准等
**表示层** ：数据压缩、加密以及数据描述，负责主机之间数据内部格式不同的问题。
**会话层** ：建立及管理会话。netstat看会话状态时在这层

TCP/IP：是一组协议，把数据链路层和物理层合并为网络接口层

##### 数据在各层之间的传递过程

向下传递的过程加上首部和尾部，向上传递拆开首部和尾部

![](https://lukkyy.github.io/assets/IT/Web/wuchengxieyi.PNG)



#### 物理层

物理层的作用是负责将数据转成比特流，规定传输媒体的标准，网线、电压标准等

通信方式：单工通信：单向传输；半双工通信：双向交替传输；全双工通信：双向同时传输

带通调制是数字信号转换为模拟信号



#### 数据链路层：

作用：把上一次网络层传下来的数据装成帧，在帧加上Mac地址，实现透明传输、差错校验等功能

封装成帧： 将网络层传下来的分组添加首部SOH和尾部ETO，用于标记帧的开始和结束

##### 透明传输

​        如果帧的**数据部分**有和首部尾部的标记符，那么就会出现误判。需要在数据部分出现首尾部标记符前面**插入转义字符**ESC。如果数据部分出现转义字符，那么就在转义字符前面再加个转义字符。在接收端进行处理之后可以还原出原始数据。这个过程用户察觉不到转义字符的存在，所以叫透明传输

差错检测： 循环冗余检验（CRC）来检查

信道分类：

1. 广播信道：一个节点发送的数据能够被广播信道上所有的节点接收到。为避免传输数据发生冲突，有两种方法协调碰撞，一个是**信道复用**技术，一是**CSMA/CD 协议**。

2. 点对点信道，一对一通信。因为不会发生碰撞，使用 PPP 协议进行控制。

#### 信道复用

频分复用:使用不同的频率通信

时分复用：把时间分成一段一段，主机轮流使用不同时段

统计时分复用：不固定每个用户在时分复用帧中的位置，只要有数据就**集中起来组成**统计时分复用帧然后发送。

波分复用：光的频分复用

码分复用

##### CSMA/CD 协议

载波监听多点接入 / 碰撞检测

载波监听: 每个主机时刻监听信道，若监听到信道正在使用，则等待

碰撞检测 ：若在发送时，监听到信道有其它主机正在发送数据，说明发生碰撞了；若经过争用期2τ 之后还没有检测到碰撞，就不会碰撞了

发生碰撞后，采用 **截断二进制指数退避算法** 来确定重新发送的时间

##### PPP 协议

PPP 协议是用户计算机和 ISP 进行通信时所使用的数据链路层协议

MAC 地址是链路层地址，长度为 6 字节（48 位），用于唯一标识网络适配器

##### 交换机

交换机具有自学习能力，学习的是交换表的内容，交换表中存储着 MAC 地址到接口的映射。



备注：路由器使用的协议只有最下面三层； 宽带的单位是比特b，不是字节B，转换成下载速度时要除8，所用10M的宽带下载速度在 1 MB/s左右 （需要负载等因素的影响，传输速度达不到理论上限）